{"version":3,"file":"js/background.js","mappings":";;;;;;;;;;;;;;AAAA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA,mBAAmB,SAAI,IAAI,SAAI;AAC/B,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,yCAAyC;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,UAAU;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iEAAe,gBAAgB,EAAC;;;;;;;;;;;AC9KhC;;AAEA,IAAI,IAA+E;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,KAAK;;;;;;UCTP;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;ACNA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA,mBAAmB,SAAI,IAAI,SAAI;AAC/B,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AAC8B;AACS;AACvC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,2DAAiB;AACpE;AACA;AACA,6CAA6C,mCAAmC,uFAAuF,GAAG,6BAA6B,OAAO,YAAY,SAAS;AACnO,yBAAyB;AACzB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,8DAAoB;AACjE;AACA;AACA;AACA;AACA;AACA,wBAAwB,6DAAmB;AAC3C;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4BAA4B,gEAAsB;AAClD,qBAAqB;AACrB;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,IAAI,iEAAuB;AAC3B,IAAI,uEAA6B;AACjC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,6DAAmB;AACvC;AACA,qBAAqB;AACrB;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4DAAkB;AAC/D;AACA;AACA;AACA;AACA,qDAAqD,cAAc;AACnE;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,gEAAsB,eAAe;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC,IAAI;AACL,8DAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC,IAAI;AACL,4DAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,wEAA8B;AAC9B,8DAAoB","sources":["webpack://shlk-main/./src/js/browser.api.ts","webpack://shlk-main/./src/js/config.js","webpack://shlk-main/webpack/bootstrap","webpack://shlk-main/webpack/runtime/compat get default export","webpack://shlk-main/webpack/runtime/define property getters","webpack://shlk-main/webpack/runtime/hasOwnProperty shorthand","webpack://shlk-main/webpack/runtime/make namespace object","webpack://shlk-main/./src/js/background.ts"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar BrowserApi = /** @class */ (function () {\n    function BrowserApi() {\n        try {\n            if (!chrome) {\n                this.isInit = false;\n            }\n            else {\n                this.isInit = true;\n            }\n        }\n        catch (_a) {\n            this.isInit = false;\n        }\n    }\n    BrowserApi.prototype.getTab = function (active) {\n        return __awaiter(this, void 0, void 0, function () {\n            var tabs, tab;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, chrome.tabs.query({ active: active, lastFocusedWindow: true })];\n                    case 1:\n                        tabs = _a.sent();\n                        tab = tabs[0];\n                        if (tab && tab.url) {\n                            return [2 /*return*/, {\n                                    url: tab.url\n                                }];\n                        }\n                        return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    BrowserApi.prototype.findTab = function (url) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (!this.isInit)\n                    return [2 /*return*/, null];\n                return [2 /*return*/, chrome.tabs.query({\n                        url: url\n                    })];\n            });\n        });\n    };\n    BrowserApi.prototype.extensionId = function () {\n        return chrome.runtime.id;\n    };\n    BrowserApi.prototype.sendMessage = function (msg) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, chrome.runtime.reload];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, chrome.runtime.sendMessage(this.extensionId(), msg)];\n                    case 2:\n                        response = _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BrowserApi.prototype.addListener = function (callback) {\n        return chrome.commands.onCommand.addListener(callback);\n    };\n    BrowserApi.prototype.onMessage = function (callback) {\n        return chrome.runtime.onMessage.addListener(callback);\n    };\n    BrowserApi.prototype.openExternal = function (url) {\n        if (!this.isInit)\n            return;\n        chrome.tabs.create({ url: url });\n    };\n    BrowserApi.prototype.setAlarm = function (name, alarm) {\n        if (!this.isInit)\n            return;\n        chrome.alarms.create(name, alarm);\n    };\n    BrowserApi.prototype.onAlarm = function (callback) {\n        if (!this.isInit)\n            return;\n        chrome.alarms.onAlarm.addListener(callback);\n    };\n    BrowserApi.prototype.onInstalled = function (callback) {\n        if (!this.isInit)\n            return null;\n        chrome.runtime.onInstalled.addListener(callback);\n    };\n    BrowserApi.prototype.onStartup = function (callback) {\n        if (!this.isInit)\n            return void 0;\n        chrome.runtime.onStartup.addListener(callback);\n    };\n    BrowserApi.prototype.getAlarms = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (!this.isInit)\n                    return [2 /*return*/, []];\n                return [2 /*return*/, chrome.alarms.getAll()];\n            });\n        });\n    };\n    BrowserApi.prototype.removeAlarm = function (name) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (!this.isInit)\n                    return [2 /*return*/, void 0];\n                return [2 /*return*/, chrome.alarms.clear(name)];\n            });\n        });\n    };\n    BrowserApi.prototype.removeAllAlarms = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (!this.isInit)\n                    return [2 /*return*/, void 0];\n                return [2 /*return*/, chrome.alarms.clearAll()];\n            });\n        });\n    };\n    BrowserApi.prototype.createNotification = function (options, id, callback) {\n        if (!this.isInit)\n            return void 0;\n        if (id) {\n            chrome.notifications.create(id, options, callback);\n        }\n        else {\n            chrome.notifications.create(options, callback);\n        }\n    };\n    BrowserApi.prototype.onNotificationClick = function (callback) {\n        if (!this.isInit)\n            return void 0;\n        chrome.notifications.onClicked.addListener(callback);\n    };\n    return BrowserApi;\n}());\nexport default new BrowserApi();\n","const tmpAddr = 'http://localhost:8002'\n\nif (process.env.NODE_ENV === 'development' && process.env.APP_TARGET == 'extension') {\n  module.exports = {\n    serviceUrl: tmpAddr,\n    displayServiceUrl: 'shlk.cc',\n    target: 'extension',\n    mode: 'development'\n  }\n} else if (process.env.NODE_ENV === 'development' && process.env.APP_TARGET == 'webapp') {\n  module.exports = {\n    serviceUrl: window.location.origin,\n    displayServiceUrl: 'shlk.cc',\n    target: 'webapp',\n    mode: 'development'\n  } \n} else if (process.env.NODE_ENV === 'production' && process.env.APP_TARGET) {\n  module.exports = {\n    serviceUrl: 'https://shlk.cc',\n    displayServiceUrl: 'shlk.cc',\n    mode: 'production',\n    target: process.env.APP_TARGET\n  }\n} else {\n  module.exports = {\n    serviceUrl: 'https://shlk.cc',\n    displayServiceUrl: 'shlk.cc',\n    target: 'webapp',\n    mode: 'production'\n  }\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport config from './config';\nimport browserApi from './browser.api';\nfunction indexAlarms(alarms) {\n    var result = {};\n    alarms.forEach(function (alarm) {\n        result[alarm.name] = alarm;\n    });\n    return result;\n}\nfunction getShortlinks(skip) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var response, responseBody;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0: return [4 /*yield*/, fetch(config.serviceUrl + '/api', {\n                        method: 'POST',\n                        body: JSON.stringify({\n                            query: \"\\n      {\\n        getUserShortlinks(args: {isSnooze: true, sort: \\\"snooze.awake\\\", order: \\\"1\\\", limit: 30, skip:\".concat(skip, \"}) {\\n          location snooze {awake} \\n        } \\n      }\")\n                        }),\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        }\n                    })];\n                case 1:\n                    response = _b.sent();\n                    if (response.status != 200)\n                        return [2 /*return*/, []];\n                    return [4 /*yield*/, response.json()];\n                case 2:\n                    responseBody = _b.sent();\n                    return [2 /*return*/, ((_a = responseBody.data) === null || _a === void 0 ? void 0 : _a.getUserShortlinks) || []];\n            }\n        });\n    });\n}\nfunction resetAlarms(links) {\n    return __awaiter(this, void 0, void 0, function () {\n        var alarms, indexedAlarms, checkAlarms;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, browserApi.getAlarms()];\n                case 1:\n                    alarms = _a.sent();\n                    indexedAlarms = indexAlarms(alarms);\n                    links.forEach(function (shortlink) {\n                        var time = /test\\-snooze/ig.test(shortlink.location) ? Date.now() + 1000 : shortlink.snooze.awake;\n                        browserApi.setAlarm(shortlink.location, {\n                            when: time\n                        });\n                        if (indexAlarms[shortlink.location])\n                            indexAlarms[shortlink.location] = undefined;\n                    });\n                    checkAlarms = Object.getOwnPropertyNames(indexedAlarms);\n                    checkAlarms.forEach(function (alarmName) {\n                        if (alarmName != 'syncSnoozedTabs' && indexAlarms[alarmName] != undefined)\n                            browserApi.removeAlarm(alarmName);\n                    });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction syncSnoozedTabs() {\n    return __awaiter(this, void 0, void 0, function () {\n        var snoozedLinks, next, threshold, chunk;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    snoozedLinks = [];\n                    next = true;\n                    threshold = new Date();\n                    threshold.setDate(threshold.getDate() + 7);\n                    _a.label = 1;\n                case 1:\n                    if (!next) return [3 /*break*/, 3];\n                    return [4 /*yield*/, getShortlinks(snoozedLinks.length)];\n                case 2:\n                    chunk = _a.sent();\n                    snoozedLinks = Array().concat(snoozedLinks, chunk);\n                    if (chunk.length < 30 || chunk[chunk.length - 1].awake >= threshold.valueOf())\n                        next = false;\n                    return [3 /*break*/, 1];\n                case 3:\n                    resetAlarms(snoozedLinks);\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction awakeTab(url) {\n    browserApi.openExternal(url);\n    browserApi.createNotification({\n        type: 'basic',\n        title: 'Woke up snoozed tab',\n        message: url,\n        iconUrl: '/assets/favicon/android-chrome-192x192.png',\n        priority: 2\n    }, url, function (result) {\n        console.log('Notification: ' + result);\n    });\n}\nfunction registerPeriodicSync() {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, syncSnoozedTabs()];\n                case 1:\n                    _a.sent();\n                    browserApi.setAlarm('syncSnoozedTabs', {\n                        periodInMinutes: 60 * 12\n                    });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction notificationClickHandle(url) {\n    return __awaiter(this, void 0, void 0, function () {\n        var tabs;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, browserApi.findTab(url)];\n                case 1:\n                    tabs = _a.sent();\n                    if (!tabs[0])\n                        return [2 /*return*/];\n                    chrome.tabs.update(tabs[0].id, { active: true });\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction messageHandler(message, sender, sendResponse) {\n    if (message.command == 'sync')\n        syncSnoozedTabs();\n    return true;\n}\nbrowserApi.onInstalled(function () { return __awaiter(void 0, void 0, void 0, function () {\n    var err_1;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                _a.trys.push([0, 2, , 3]);\n                console.log('installed');\n                return [4 /*yield*/, registerPeriodicSync()];\n            case 1:\n                _a.sent();\n                return [3 /*break*/, 3];\n            case 2:\n                err_1 = _a.sent();\n                console.error(err_1);\n                return [3 /*break*/, 3];\n            case 3: return [2 /*return*/];\n        }\n    });\n}); });\nbrowserApi.onStartup(function () { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0: return [4 /*yield*/, syncSnoozedTabs()];\n            case 1:\n                _a.sent();\n                return [2 /*return*/];\n        }\n    });\n}); });\nbrowserApi.onAlarm(function (alarm) {\n    if (alarm.name == 'syncSnoozedTabs') {\n        syncSnoozedTabs();\n    }\n    else {\n        awakeTab(alarm.name);\n    }\n});\nbrowserApi.onNotificationClick(notificationClickHandle);\nbrowserApi.onMessage(messageHandler);\n"],"names":[],"sourceRoot":""}